const captainPicks = captainCandidates
              .sort((a, b) => b.captainScore - a.captainScore)
              .slice(0, 5);
            
            // Build optimal squad within budget
            const buildOptimalSquad = () => {
              const budget = 1000; // ¬£100m = 1000 in API units
              const squad = {
                goalkeepers: [],
                defenders: [],
                midfielders: [],
                forwards: []
              };
              
              // Get top players by position sorted by value
              const gkCandidates = availablePlayers.filter(p => p.element_type === 1).sort((a, b) => b.score - a.score);
              const defCandidates = availablePlayers.filter(p => p.element_type === 2).sort((a, b) => b.score - a.score);
              const midCandidates = availablePlayers.filter(p => p.element_type === 3).sort((a, b) => b.score - a.score);
              const fwdCandidates = availablePlayers.filter(p => p.element_type === 4).sort((a, b) => b.score - a.score);
              
              // Greedy algorithm: Pick best value players that fit budget
              // Formation: 2 GK, 5 DEF, 5 MID, 3 FWD
              let remainingBudget = budget;
              
              // Select 2 goalkeepers (1 premium, 1 budget)
              if (gkCandidates.length >= 2) {
                squad.goalkeepers.push(gkCandidates[0]);
                remainingBudget -= gkCandidates[0].now_cost;
                
                // Find cheapest playable GK
                const budgetGk = gkCandidates.filter(p => p.now_cost <= 45).sort((a, b) => b.score - a.score)[0];
                if (budgetGk && budgetGk.id !== squad.goalkeepers[0].id) {
                  squad.goalkeepers.push(budgetGk);
                  remainingBudget -= budgetGk.now_cost;
                }
              }
              
              // Select 5 defenders
              for (let i = 0; i < defCandidates.length && squad.defenders.length < 5; i++) {
                const player = defCandidates[i];
                if (player.now_cost <= remainingBudget) {
                  squad.defenders.push(player);
                  remainingBudget -= player.now_cost;
                }
              }
              
              // Select 5 midfielders
              for (let i = 0; i < midCandidates.length && squad.midfielders.length < 5; i++) {
                const player = midCandidates[i];
                if (player.now_cost <= remainingBudget) {
                  squad.midfielders.push(player);
                  remainingBudget -= player.now_cost;
                }
              }
              
              // Select 3 forwards
              for (let i = 0; i < fwdCandidates.length && squad.forwards.length < 3; i++) {
                const player = fwdCandidates[i];
                if (player.now_cost <= remainingBudget) {
                  squad.forwards.push(player);
                  remainingBudget -= player.now_cost;
                }
              }
              
              const totalCost = budget - remainingBudget;
              const allPlayers = [...squad.goalkeepers, ...squad.defenders, ...squad.midfielders, ...squad.forwards];
              
              return {
                squad,
                totalCost,
                remainingBudget,
                playerCount: allPlayers.length
              };
            };
            
            const optimalSquad = buildOptimalSquad();
            
            // Build optimal squad within budget
            const buildOptimalSquad = () => {
              const budget = 1000; // ¬£100m = 1000 in API units
              const squad = {
                goalkeepers: [],
                defenders: [],
                midfielders: [],
                forwards: []
              };
              
              // Get top players by position sorted by value
              const gkCandidates = availablePlayers.filter(p => p.element_type === 1).sort((a, b) => b.score - a.score);
              const defCandidates = availablePlayers.filter(p => p.element_type === 2).sort((a, b) => b.score - a.score);
              const midCandidates = availablePlayers.filter(p => p.element_type === 3).sort((a, b) => b.score - a.score);
              const fwdCandidates = availablePlayers.filter(p => p.element_type === 4).sort((a, b) => b.score - a.score);
              
              // Greedy algorithm: Pick best value players that fit budget
              // Formation: 2 GK, 5 DEF, 5 MID, 3 FWD
              let remainingBudget = budget;
              
              // Select 2 goalkeepers (1 premium, 1 budget)
              if (gkCandidates.length >= 2) {
                squad.goalkeepers.push(gkCandidates[0]);
                remainingBudget -= gkCandidates[0].now_cost;
                
                // Find cheapest playable GK
                const budgetGk = gkCandidates.filter(p => p.now_cost <= 45).<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPL Gameweek Recommendations Tool</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const FPLAnalyzer = () => {
          const [loading, setLoading] = useState(false);
          const [players, setPlayers] = useState([]);
          const [teams, setTeams] = useState({});
          const [fixtures, setFixtures] = useState([]);
          const [recommendations, setRecommendations] = useState(null);
          const [error, setError] = useState(null);
          const [currentGameweek, setCurrentGameweek] = useState(null);
          const [showManualInput, setShowManualInput] = useState(false);
          const [manualData, setManualData] = useState('');

          const corsProxies = [
            'https://corsproxy.io/?',
            'https://api.allorigins.win/raw?url=',
            'https://cors-anywhere.herokuapp.com/'
          ];

          const fetchFPLData = async () => {
            setLoading(true);
            setError(null);
            
            for (let i = 0; i < corsProxies.length; i++) {
              try {
                const proxy = corsProxies[i];
                console.log(`Trying proxy ${i + 1}/${corsProxies.length}: ${proxy}`);
                
                const response = await fetch(proxy + encodeURIComponent('https://fantasy.premierleague.com/api/bootstrap-static/'));
                
                if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                const teamsMap = {};
                data.teams.forEach(team => {
                  teamsMap[team.id] = team;
                });
                
                setTeams(teamsMap);
                setPlayers(data.elements);
                
                const currentGW = data.events.find(gw => gw.is_current);
                setCurrentGameweek(currentGW ? currentGW.id : null);
                
                const fixturesResponse = await fetch(proxy + encodeURIComponent('https://fantasy.premierleague.com/api/fixtures/'));
                
                if (!fixturesResponse.ok) {
                  throw new Error(`HTTP error! status: ${fixturesResponse.status}`);
                }
                
                const fixturesData = await fixturesResponse.json();
                setFixtures(fixturesData);
                
                analyzeData(data.elements, teamsMap, fixturesData, currentGW ? currentGW.id : null);
                setLoading(false);
                return;
                
              } catch (err) {
                console.error(`Proxy ${i + 1} failed:`, err);
                if (i === corsProxies.length - 1) {
                  setError(
                    `All API fetch methods failed. Please use the manual data input option below.`
                  );
                }
              }
            }
            
            setLoading(false);
          };

          const handleManualDataSubmit = () => {
            try {
              setLoading(true);
              setError(null);
              
              const data = JSON.parse(manualData);
              
              if (!data.elements || !data.teams || !data.events) {
                throw new Error('Invalid data format. Please paste the complete bootstrap-static API response.');
              }
              
              const teamsMap = {};
              data.teams.forEach(team => {
                teamsMap[team.id] = team;
              });
              
              setTeams(teamsMap);
              setPlayers(data.elements);
              
              const currentGW = data.events.find(gw => gw.is_current);
              setCurrentGameweek(currentGW ? currentGW.id : null);
              
              analyzeData(data.elements, teamsMap, [], currentGW ? currentGW.id : null);
              
              setShowManualInput(false);
              setManualData('');
              
            } catch (err) {
              setError(`Error parsing data: ${err.message}`);
            } finally {
              setLoading(false);
            }
          };

                      const analyzeData = (playersData, teamsMap, fixturesData, currentGW) => {
            const nextGW = currentGW ? currentGW + 1 : null;
            
            const upcomingFixtures = fixturesData.filter(f => f.event === nextGW);
            
            // Create a map of team fixtures for easy lookup
            const teamFixturesMap = {};
            upcomingFixtures.forEach(fixture => {
              const homeTeam = fixture.team_h;
              const awayTeam = fixture.team_a;
              
              if (!teamFixturesMap[homeTeam]) teamFixturesMap[homeTeam] = [];
              if (!teamFixturesMap[awayTeam]) teamFixturesMap[awayTeam] = [];
              
              teamFixturesMap[homeTeam].push({
                opponent: teamsMap[awayTeam]?.short_name || 'Unknown',
                isHome: true,
                difficulty: fixture.team_h_difficulty
              });
              
              teamFixturesMap[awayTeam].push({
                opponent: teamsMap[homeTeam]?.short_name || 'Unknown',
                isHome: false,
                difficulty: fixture.team_a_difficulty
              });
            });
            
            const calculateFixtureDifficulty = (teamId) => {
              const teamFixtures = upcomingFixtures.filter(
                f => f.team_h === teamId || f.team_a === teamId
              );
              
              if (teamFixtures.length === 0) return 3;
              
              return teamFixtures.reduce((sum, fixture) => {
                const difficulty = fixture.team_h === teamId 
                  ? fixture.team_h_difficulty 
                  : fixture.team_a_difficulty;
                return sum + difficulty;
              }, 0) / teamFixtures.length;
            };
            
            const scoredPlayers = playersData.map(player => {
              const form = parseFloat(player.form) || 0;
              const pointsPerGame = player.minutes > 0 ? player.total_points / player.minutes * 90 : 0;
              const selectedBy = parseFloat(player.selected_by_percent) || 0;
              const valueScore = player.now_cost > 0 ? (player.total_points / player.now_cost) * 10 : 0;
              const fixtureDifficulty = calculateFixtureDifficulty(player.team);
              const fixtureScore = (5 - fixtureDifficulty) * 2;
              
              // Get fixture info for this player's team
              const fixtures = teamFixturesMap[player.team] || [];
              const fixtureString = fixtures.length > 0 
                ? fixtures.map(f => `${f.isHome ? 'vs' : '@'} ${f.opponent}`).join(', ')
                : 'No fixture';
              
              // Calculate average points per game (more reliable than PPG from minutes)
              const gamesPlayed = player.starts || 1;
              const avgPointsPerGame = player.total_points / gamesPlayed;
              
              const score = (
                form * 3 +
                pointsPerGame * 2 +
                valueScore * 2 +
                fixtureScore * 1.5 +
                (player.minutes > 500 ? 5 : 0) +
                (player.ict_index ? parseFloat(player.ict_index) / 20 : 0)
              );
              
              // Special captain score that heavily weights consistency and total points
              const captainScore = (
                avgPointsPerGame * 5 +                           // High weight on average points
                player.total_points * 0.5 +                      // Reward total season points
                form * 4 +                                       // Recent form is crucial
                fixtureScore * 2 +                               // Good fixtures matter
                (player.minutes > 1000 ? 15 : 0) +               // Must be a regular starter
                (player.ict_index ? parseFloat(player.ict_index) / 15 : 0) +
                (player.bonus ? player.bonus * 2 : 0) +          // Bonus point magnets
                (selectedBy > 20 ? 5 : 0)                        // Template players get bonus
              );
              
              return {
                ...player,
                score,
                captainScore,
                avgPointsPerGame,
                form,
                fixtureDifficulty,
                valueScore,
                fixtureString
              };
            });
            
            const availablePlayers = scoredPlayers.filter(p => 
              p.status === 'a' && 
              (p.chance_of_playing_next_round === null || p.chance_of_playing_next_round >= 75) &&
              p.minutes > 500  // Must have played at least 500 minutes this season
            );
            
            const byPosition = {
              1: availablePlayers.filter(p => p.element_type === 1).sort((a, b) => b.score - a.score).slice(0, 10),
              2: availablePlayers.filter(p => p.element_type === 2).sort((a, b) => b.score - a.score).slice(0, 15),
              3: availablePlayers.filter(p => p.element_type === 3).sort((a, b) => b.score - a.score).slice(0, 15),
              4: availablePlayers.filter(p => p.element_type === 4).sort((a, b) => b.score - a.score).slice(0, 15)
            };
            
            // Captain picks: use special captain score and filter for premium, reliable players
            const captainCandidates = availablePlayers.filter(p => 
              p.minutes > 1000 &&                                    // Regular starters only
              p.total_points > 50 &&                                 // Must have decent season total
              (p.element_type === 3 || p.element_type === 4)        // Midfielders and forwards only
            );
            
            const captainPicks = captainCandidates
              .sort((a, b) => b.captainScore - a.captainScore)
              .slice(0, 5);
            
            const differentials = availablePlayers
              .filter(p => parseFloat(p.selected_by_percent) < 5 && p.score > 10)
              .sort((a, b) => b.score - a.score)
              .slice(0, 10);
            
            setRecommendations({
              byPosition,
              captainPicks,
              differentials,
              nextGameweek: nextGW,
              optimalSquad
            });
          };

          const getPositionName = (elementType) => {
            const positions = { 1: 'Goalkeeper', 2: 'Defender', 3: 'Midfielder', 4: 'Forward' };
            return positions[elementType];
          };

          const formatPrice = (price) => {
            return `¬£${(price / 10).toFixed(1)}m`;
          };

          return (
            <div className="min-h-screen bg-gray-900 p-4">
              <div className="max-w-7xl mx-auto">
                <div className="bg-purple-900 rounded-lg shadow-2xl p-6 mb-6 border border-purple-700">
                  <div className="flex items-center justify-between mb-4 flex-wrap gap-4">
                    <div>
                      <h1 className="text-3xl font-bold text-white flex items-center gap-2">
                        ‚öΩ FPL Gameweek Recommendations
                      </h1>
                      <p className="text-purple-200 mt-1">Data-driven insights for your Fantasy Premier League team</p>
                    </div>
                    <div className="flex gap-2">
                      <button
                        onClick={fetchFPLData}
                        disabled={loading}
                        className="bg-purple-600 hover:bg-purple-500 text-white px-6 py-3 rounded-lg flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-semibold border border-purple-500"
                      >
                        {loading ? '‚è≥' : 'üîÑ'} {loading ? 'Loading...' : 'Auto Fetch'}
                      </button>
                      <button
                        onClick={() => setShowManualInput(!showManualInput)}
                        className="bg-gray-800 border-2 border-purple-600 text-white hover:bg-gray-700 px-6 py-3 rounded-lg flex items-center gap-2 transition-all font-semibold"
                      >
                        üì§ Manual Input
                      </button>
                    </div>
                  </div>
                  
                  {showManualInput && (
                    <div className="bg-gray-800 rounded-lg p-4 mb-4 border-2 border-purple-600">
                      <h3 className="font-semibold text-white mb-2 flex items-center gap-2">
                        üìù Manual Data Input
                      </h3>
                      <p className="text-sm text-purple-200 mb-3">
                        1. Visit: <a href="https://fantasy.premierleague.com/api/bootstrap-static/" target="_blank" rel="noopener noreferrer" className="text-purple-400 underline font-semibold hover:text-purple-300">https://fantasy.premierleague.com/api/bootstrap-static/</a>
                        <br />
                        2. Copy all the JSON data from that page (Ctrl+A, Ctrl+C)
                        <br />
                        3. Paste it in the box below and click "Analyze Data"
                      </p>
                      <textarea
                        value={manualData}
                        onChange={(e) => setManualData(e.target.value)}
                        placeholder="Paste the complete JSON data here..."
                        className="w-full h-32 p-3 bg-gray-900 border-2 border-purple-600 rounded-lg font-mono text-sm mb-3 focus:border-purple-400 focus:outline-none text-white placeholder-gray-500"
                      />
                      <button
                        onClick={handleManualDataSubmit}
                        disabled={!manualData.trim() || loading}
                        className="bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-semibold border border-purple-500"
                      >
                        ‚úÖ Analyze Data
                      </button>
                    </div>
                  )}
                  
                  {currentGameweek && (
                    <div className="bg-purple-800 rounded-lg p-4 mb-4 border-l-4 border-purple-500">
                      <p className="text-white font-semibold">
                        üìÖ Current Gameweek: {currentGameweek} | Next Gameweek: {currentGameweek + 1}
                      </p>
                    </div>
                  )}
                  
                  {error && (
                    <div className="bg-red-900 border border-red-700 rounded-lg p-4 flex items-start gap-2 text-red-100">
                      <span className="text-xl">‚ö†Ô∏è</span>
                      <div>
                        <p className="font-semibold">Error</p>
                        <p className="text-sm">{error}</p>
                      </div>
                    </div>
                  )}
                </div>

                {recommendations && (
                  <>
                    <div className="bg-purple-900 rounded-lg shadow-xl p-6 mb-6 border border-purple-700">
                      <h2 className="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                        üèÜ Optimal 15-Man Squad (¬£100m Budget)
                      </h2>
                      <div className="bg-purple-800 rounded-lg p-4 mb-4 border border-purple-600">
                        <div className="flex justify-between items-center text-white">
                          <div>
                            <span className="text-purple-300">Total Cost:</span>
                            <span className="font-bold text-xl ml-2">{formatPrice(recommendations.optimalSquad.totalCost)}</span>
                          </div>
                          <div>
                            <span className="text-purple-300">Remaining:</span>
                            <span className="font-bold text-xl ml-2 text-green-400">{formatPrice(recommendations.optimalSquad.remainingBudget)}</span>
                          </div>
                          <div>
                            <span className="text-purple-300">Players:</span>
                            <span className="font-bold text-xl ml-2">{recommendations.optimalSquad.playerCount}/15</span>
                          </div>
                        </div>
                      </div>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {/* Goalkeepers */}
                        <div>
                          <h3 className="text-lg font-semibold text-purple-300 mb-3">Goalkeepers (2)</h3>
                          <div className="space-y-2">
                            {recommendations.optimalSquad.squad.goalkeepers.map((player, idx) => (
                              <div key={player.id} className="bg-purple-800 rounded-lg p-3 border border-purple-600">
                                <div className="flex justify-between items-start">
                                  <div>
                                    <div className="font-bold text-white">{player.web_name}</div>
                                    <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                                    <div className="text-xs text-purple-400 mt-1">{player.fixtureString}</div>
                                  </div>
                                  <div className="text-right">
                                    <div className="font-bold text-white">{formatPrice(player.now_cost)}</div>
                                    <div className="text-sm text-green-400">{player.total_points} pts</div>
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                        
                        {/* Defenders */}
                        <div>
                          <h3 className="text-lg font-semibold text-purple-300 mb-3">Defenders (5)</h3>
                          <div className="space-y-2">
                            {recommendations.optimalSquad.squad.defenders.map((player, idx) => (
                              <div key={player.id} className="bg-purple-800 rounded-lg p-3 border border-purple-600">
                                <div className="flex justify-between items-start">
                                  <div>
                                    <div className="font-bold text-white">{player.web_name}</div>
                                    <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                                    <div className="text-xs text-purple-400 mt-1">{player.fixtureString}</div>
                                  </div>
                                  <div className="text-right">
                                    <div className="font-bold text-white">{formatPrice(player.now_cost)}</div>
                                    <div className="text-sm text-green-400">{player.total_points} pts</div>
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                        
                        {/* Midfielders */}
                        <div>
                          <h3 className="text-lg font-semibold text-purple-300 mb-3">Midfielders (5)</h3>
                          <div className="space-y-2">
                            {recommendations.optimalSquad.squad.midfielders.map((player, idx) => (
                              <div key={player.id} className="bg-purple-800 rounded-lg p-3 border border-purple-600">
                                <div className="flex justify-between items-start">
                                  <div>
                                    <div className="font-bold text-white">{player.web_name}</div>
                                    <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                                    <div className="text-xs text-purple-400 mt-1">{player.fixtureString}</div>
                                  </div>
                                  <div className="text-right">
                                    <div className="font-bold text-white">{formatPrice(player.now_cost)}</div>
                                    <div className="text-sm text-green-400">{player.total_points} pts</div>
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                        
                        {/* Forwards */}
                        <div>
                          <h3 className="text-lg font-semibold text-purple-300 mb-3">Forwards (3)</h3>
                          <div className="space-y-2">
                            {recommendations.optimalSquad.squad.forwards.map((player, idx) => (
                              <div key={player.id} className="bg-purple-800 rounded-lg p-3 border border-purple-600">
                                <div className="flex justify-between items-start">
                                  <div>
                                    <div className="font-bold text-white">{player.web_name}</div>
                                    <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                                    <div className="text-xs text-purple-400 mt-1">{player.fixtureString}</div>
                                  </div>
                                  <div className="text-right">
                                    <div className="font-bold text-white">{formatPrice(player.now_cost)}</div>
                                    <div className="text-sm text-green-400">{player.total_points} pts</div>
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="bg-purple-900 rounded-lg shadow-xl p-6 mb-6 border border-purple-700">
                      <h2 className="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                        üéØ Top Captain Picks (GW {recommendations.nextGameweek})
                      </h2>
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                        {recommendations.captainPicks.map((player, idx) => (
                          <div key={player.id} className="bg-purple-800 rounded-lg p-4 border-2 border-purple-600 hover:border-purple-400 transition-all">
                            <div className="text-2xl font-bold text-purple-300 mb-1">#{idx + 1}</div>
                            <div className="font-bold text-white">{player.web_name}</div>
                            <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                            <div className="text-sm text-purple-200">{getPositionName(player.element_type)}</div>
                            <div className="text-xs font-semibold text-purple-400 mt-1 mb-2">
                              {player.fixtureString}
                            </div>
                            <div className="mt-2 space-y-1 text-xs">
                              <div className="flex justify-between">
                                <span className="text-purple-300">Form:</span>
                                <span className="font-semibold text-white">{player.form}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-purple-300">Avg PPG:</span>
                                <span className="font-semibold text-green-400">{player.avgPointsPerGame.toFixed(1)}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-purple-300">Price:</span>
                                <span className="font-semibold text-white">{formatPrice(player.now_cost)}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-purple-300">Total:</span>
                                <span className="font-semibold text-white">{player.total_points} pts</span>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div className="bg-purple-900 rounded-lg shadow-xl p-6 mb-6 border border-purple-700">
                      <h2 className="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                        üë• Top Picks by Position
                      </h2>
                      
                      {[1, 2, 3, 4].map(position => (
                        <div key={position} className="mb-6 last:mb-0">
                          <h3 className="text-xl font-semibold text-purple-300 mb-3">
                            {getPositionName(position)}s
                          </h3>
                          <div className="overflow-x-auto">
                            <table className="w-full">
                              <thead className="bg-purple-800">
                                <tr>
                                  <th className="px-4 py-2 text-left text-sm font-semibold text-white">Player</th>
                                  <th className="px-4 py-2 text-left text-sm font-semibold text-white">Team</th>
                                  <th className="px-4 py-2 text-left text-sm font-semibold text-white">Fixture</th>
                                  <th className="px-4 py-2 text-center text-sm font-semibold text-white">Price</th>
                                  <th className="px-4 py-2 text-center text-sm font-semibold text-white">Form</th>
                                  <th className="px-4 py-2 text-center text-sm font-semibold text-white">Points</th>
                                  <th className="px-4 py-2 text-center text-sm font-semibold text-white">Selected %</th>
                                  <th className="px-4 py-2 text-center text-sm font-semibold text-white">Difficulty</th>
                                </tr>
                              </thead>
                              <tbody>
                                {recommendations.byPosition[position].slice(0, 5).map((player, idx) => (
                                  <tr key={player.id} className={idx % 2 === 0 ? 'bg-purple-800 bg-opacity-40' : 'bg-purple-900 bg-opacity-40'}>
                                    <td className="px-4 py-3 font-medium text-white">{player.web_name}</td>
                                    <td className="px-4 py-3 text-purple-200">{teams[player.team]?.short_name}</td>
                                    <td className="px-4 py-3 text-sm text-purple-400 font-medium">{player.fixtureString}</td>
                                    <td className="px-4 py-3 text-center text-white">{formatPrice(player.now_cost)}</td>
                                    <td className="px-4 py-3 text-center font-semibold text-green-400">{player.form}</td>
                                    <td className="px-4 py-3 text-center text-white">{player.total_points}</td>
                                    <td className="px-4 py-3 text-center text-purple-200">{player.selected_by_percent}%</td>
                                    <td className="px-4 py-3 text-center">
                                      <span className={`px-2 py-1 rounded text-xs font-semibold ${
                                        player.fixtureDifficulty <= 2 ? 'bg-green-600 text-white' :
                                        player.fixtureDifficulty <= 3 ? 'bg-yellow-600 text-white' :
                                        'bg-red-600 text-white'
                                      }`}>
                                        {player.fixtureDifficulty.toFixed(1)}
                                      </span>
                                    </td>
                                  </tr>
                                ))}
                              </tbody>
                            </table>
                          </div>
                        </div>
                      ))}
                    </div>

                    <div className="bg-purple-900 rounded-lg shadow-xl p-6 border border-purple-700">
                      <h2 className="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                        üíé Differential Picks (Low Ownership)
                      </h2>
                      <p className="text-purple-200 mb-4">Players owned by less than 5% who could be great differentials</p>
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                        {recommendations.differentials.slice(0, 5).map((player) => (
                          <div key={player.id} className="bg-purple-800 rounded-lg p-4 border-2 border-purple-600 hover:border-purple-400 transition-all">
                            <div className="font-bold text-white">{player.web_name}</div>
                            <div className="text-sm text-purple-200">{teams[player.team]?.short_name}</div>
                            <div className="text-sm text-purple-200">{getPositionName(player.element_type)}</div>
                            <div className="text-xs font-semibold text-purple-400 mt-1 mb-2">
                              {player.fixtureString}
                            </div>
                            <div className="mt-2 space-y-1 text-xs">
                              <div className="flex justify-between">
                                <span className="text-purple-300">Price:</span>
                                <span className="font-semibold text-white">{formatPrice(player.now_cost)}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-purple-300">Form:</span>
                                <span className="font-semibold text-white">{player.form}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-purple-300">Owned:</span>
                                <span className="font-semibold text-purple-400">{player.selected_by_percent}%</span>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </>
                )}

                {!recommendations && !loading && (
                  <div className="bg-purple-900 rounded-lg shadow-xl p-12 text-center border border-purple-700">
                    <div className="text-6xl mb-4">‚öΩ</div>
                    <h3 className="text-xl font-semibold text-white mb-2">Ready to analyze FPL data</h3>
                    <p className="text-purple-200 mb-4">Click "Auto Fetch" to try automatic data retrieval, or use "Manual Input" if that doesn't work</p>
                    <div className="bg-purple-800 rounded-lg p-4 text-sm text-left max-w-2xl mx-auto border-2 border-purple-600">
                      <p className="font-semibold mb-2 text-white">Manual Input Instructions:</p>
                      <ol className="list-decimal list-inside space-y-1 text-purple-200">
                        <li>Click the "Manual Input" button above</li>
                        <li>Visit the FPL API URL in a new tab</li>
                        <li>Copy all the JSON data from that page</li>
                        <li>Paste it into the text box and click "Analyze Data"</li>
                      </ol>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        };

        ReactDOM.render(<FPLAnalyzer />, document.getElementById('root'));
    </script>
</body>
</html>
